<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<title>GPS Radar FR ‚Äî N√©on</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>

<!-- Leaflet + outils -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Leaflet Routing (OSRM public) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css"/>
<script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>

<!-- Geocoder (Nominatim) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css"/>
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

<!-- Clustering radars -->
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"/>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

<!-- CSV parse -->
<script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root{
  --bg:#05070b; --fg:#bfe9ff; --muted:#7aa6c7;
  --neon:#00e1ff; --accent:#00ffa6; --warn:#ff7ae6; --route:#00ffd5;
  --panel:#08101a; --border:#1b324d;
}
html,body,#app{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,Segoe UI,Roboto,Arial}
#map{height:100%;width:100%}
#hud{
  position:fixed; top:15px; left:15px; right:15px; z-index:1000;
  display:grid; grid-template-columns: 1fr; gap:12px;
  background:linear-gradient(135deg, rgba(0,225,255,.15), rgba(0,255,166,.08));
  border:1px solid var(--border); border-radius:20px; padding:16px;
  box-shadow:0 8px 32px rgba(0,225,255,.3), inset 0 1px 0 rgba(255,255,255,.1); 
  backdrop-filter:blur(12px);
  max-height:50vh; overflow-y:auto;
}
.badge{
  display:flex; align-items:center; gap:10px; padding:12px 16px; border-radius:16px;
  background:rgba(8,16,26,.8); border:1px solid rgba(27,50,77,.6); color:var(--fg); font-size:14px;
  transition:all 0.3s ease; backdrop-filter:blur(8px);
}
.badge:hover{
  background:rgba(8,16,26,.9); border-color:var(--neon); transform:translateY(-1px);
  box-shadow:0 4px 12px rgba(0,225,255,.2);
}
.badge input, .badge button{
  background:rgba(6,16,26,.9); color:var(--fg); border:1px solid var(--border); border-radius:12px; padding:12px 16px;
  font-size:15px; min-height:48px; touch-action:manipulation; transition:all 0.2s ease;
}
.badge button{ cursor:pointer; white-space:nowrap; font-weight:500; }
.badge button:hover{ background:rgba(0,225,255,.1); border-color:var(--neon); }
.badge input{ flex:1; min-width:0; }
.badge input:focus{ outline:none; border-color:var(--neon); box-shadow:0 0 0 2px rgba(0,225,255,.2); }
#speed{ font-size:22px; font-weight:700; text-shadow:0 0 12px var(--neon); }
.pin{
  width:14px; height:14px; border-radius:50%;
  background: radial-gradient(circle at 50% 40%, var(--neon), #0088aa 60%, rgba(0,0,0,0) 61%);
  border:1px solid rgba(0,225,255,.8); box-shadow:0 0 18px rgba(0,225,255,.9), 0 0 36px rgba(0,225,255,.4);
}
.radarAlert{
  position:fixed; bottom:16px; left:10px; right:10px; z-index:1000;
  background:#090e1b; border:1px solid var(--border); border-radius:14px; padding:12px 16px;
  box-shadow:0 0 18px rgba(0,225,255,.25); color:var(--fg); font-size:14px;
  text-align:center;
}
a.link{ color:var(--fg) }
.leaflet-routing-container{ display:none } /* UI native masqu√©e : on pilote via HUD */
.suggestions-dropdown{
  position:absolute; top:100%; left:0; right:0; z-index:1001;
  background:var(--panel); border:1px solid var(--border); border-radius:8px;
  max-height:200px; overflow-y:auto; display:none;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
}
.suggestion-item{
  padding:8px 12px; cursor:pointer; border-bottom:1px solid var(--border);
  color:var(--fg); font-size:13px;
}
.suggestion-item:hover{ background:rgba(0,225,255,0.1); }
.suggestion-item:last-child{ border-bottom:none; }
.suggestion-item.selected{ background:rgba(0,225,255,0.2); }

/* Styles pour le bouton de recentrage */
#recenterBtn {
  position: fixed;
  bottom: 85px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1000;
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, rgba(0,225,255,.2), rgba(0,255,166,.1));
  border: 1px solid var(--border);
  border-radius: 50%;
  color: var(--neon);
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(12px);
  box-shadow: 0 4px 12px rgba(0,225,255,.3);
  transition: all 0.3s ease;
  display: none;
}

#recenterBtn:hover {
  background: linear-gradient(135deg, rgba(0,225,255,.3), rgba(0,255,166,.15));
  transform: scale(1.1);
}

#recenterBtn.show {
  display: flex;
}

/* Media queries pour mobile */
@media (max-width: 768px) {
  #search-bar-top {
    top: 10px;
    left: 10px;
    right: 10px;
    gap: 8px;
  }

  #speed-hud {
    top: 70px;
    left: 10px;
  }

  #info-hud {
    top: 70px;
    right: 10px;
    flex-direction: column;
  }

  .badge {
    padding: 10px 12px;
    border-radius: 12px;
  }

  .info-card {
    padding: 8px;
    min-height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #speed, #heading {
    font-size: 16px !important;
  }

  #nextRadar {
    font-size: 9px !important;
  }

  .radarAlert {
    bottom: 90px;
    left: 10px;
    right: 10px;
    padding: 12px 16px;
    font-size: 13px;
    border-radius: 16px;
  }

  #travelTime {
    bottom: 140px;
    right: 10px;
    font-size: 12px;
    max-width: 130px;
    padding: 10px 12px;
    border-radius: 16px;
  }

  #recenterBtn {
    bottom: 75px;
    left: 50%;
    transform: translateX(-50%);
    width: 45px;
    height: 45px;
    font-size: 18px;
  }
}

@media (max-width: 480px) {
  #search-bar-top {
    gap: 6px;
  }

  #info-hud {
    gap: 4px;
  }

  .badge {
    font-size: 13px;
  }

  #travelTime {
    bottom: 130px;
    max-width: 110px;
    font-size: 11px;
  }
}

@media (max-width: 480px) {
  .badge input[placeholder] {
    font-size: 14px;
  }

  .badge input::placeholder {
    font-size: 12px;
  }
}

/* Emp√™cher l'agrandissement automatique sur mobile */
input, button, select, textarea {
  font-size: 16px !important;
  transform-origin: left top;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

/* Forcer la taille des √©l√©ments d'interface */
.badge input, .badge button {
  font-size: 16px !important;
  zoom: 1;
  -webkit-text-size-adjust: none;
  -moz-text-size-adjust: none;
  -ms-text-size-adjust: none;
  text-size-adjust: none;
}

/* Permettre seulement le zoom sur la carte */
#map {
  touch-action: manipulation;
}

/* Emp√™cher le zoom sur tous les autres √©l√©ments */
#hud, #search-bar-top, #speed-hud, #info-hud, #control-hud, .badge, .radarAlert, #travelTime, #recenterBtn {
  touch-action: pan-x pan-y;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
</style>
</head>
<body>
<div id="app">
  <!-- Barre de recherche en haut -->
  <div id="search-bar-top" style="position:fixed; top:15px; left:15px; right:15px; z-index:1000; display:flex; align-items:center; gap:12px;">
    <div style="flex:1; background:linear-gradient(135deg, rgba(0,225,255,.15), rgba(0,255,166,.08)); border:1px solid var(--border); border-radius:16px; padding:8px 12px; position:relative;">
      <input id="dest" placeholder="Rechercher une destination..." style="width:100%; background:transparent; border:none; color:var(--fg); font-size:14px; padding:8px 40px 8px 12px;"/>
      <div style="position:absolute; right:12px; top:50%; transform:translateY(-50%); color:var(--muted); font-size:16px;">üîç</div>
      <div id="suggestions" class="suggestions-dropdown" style="bottom:auto; top:100%;"></div>
    </div>
    <button id="go" style="background:linear-gradient(135deg, #0066ff, #003366); color:var(--neon); font-weight:600; padding:12px 16px; font-size:14px; border-radius:12px; white-space:nowrap; border:1px solid var(--border);">Aller</button>
  </div>

  <!-- Vitesse en haut √† gauche -->
  <div id="speed-hud" style="position:fixed; top:80px; left:15px; z-index:1000;">
    <div class="badge info-card" style="background:linear-gradient(135deg, rgba(0,225,255,.15), rgba(0,255,166,.08));">
      <div style="text-align:center;">
        <div style="font-size:11px; color:var(--muted); margin-bottom:4px;">VITESSE</div>
        <div id="speed" style="font-size:18px; font-weight:700; color:var(--neon);">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- Direction et Radar en haut √† droite -->
  <div id="info-hud" style="position:fixed; top:80px; right:15px; z-index:1000; display:flex; gap:8px;">
    <div class="badge info-card" style="background:linear-gradient(135deg, rgba(0,225,255,.15), rgba(0,255,166,.08));">
      <div style="text-align:center;">
        <div style="font-size:11px; color:var(--muted); margin-bottom:4px;">DIRECTION</div>
        <div id="heading" style="font-size:18px; font-weight:700; color:var(--accent);">‚Äî</div>
      </div>
    </div>
    <div class="badge info-card" style="background:linear-gradient(135deg, rgba(0,225,255,.15), rgba(0,255,166,.08));">
      <div style="text-align:center;">
        <div style="font-size:11px; color:var(--muted); margin-bottom:4px;">RADAR</div>
        <div id="nextRadar" style="font-size:10px; font-weight:500; color:var(--warn); line-height:1.2;">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- Boutons de contr√¥le en bas -->
  <div id="control-hud" style="position:fixed; bottom:15px; left:15px; right:15px; z-index:1000; display:flex; align-items:center; justify-content:center; gap:8px;">
    <button id="follow" style="background:linear-gradient(135deg, #001133, #004466); color:var(--neon); font-weight:600; padding:12px 20px; font-size:14px; border-radius:12px; border:1px solid var(--border);">üìç Suivre</button>
    <button id="gyro" style="background:linear-gradient(135deg, #331100, #664400); color:var(--muted); border:1px solid var(--border); padding:12px 16px; font-size:14px; border-radius:12px;">üß≠ Gyro</button>
    <button id="talk" style="background:linear-gradient(135deg, #000a1a, #002244); color:var(--neon); border:1px solid var(--border); padding:12px 16px; font-size:14px; border-radius:12px;">üéôÔ∏è Vocal</button>
  </div>

  <!-- Bouton de recentrage -->
  <button id="recenterBtn" title="Recentrer sur ma position">üéØ</button>

  <div id="map"></div>
  <div class="radarAlert" id="alert" style="display:none"></div>
  <div id="travelTime" style="position:fixed; bottom:100px; right:10px; z-index:1000; background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:10px 12px; box-shadow:0 0 18px rgba(0,225,255,.25); color:var(--fg); font-size:13px; display:none; max-width:140px;">
    <div style="font-weight:600; margin-bottom:4px;">Temps de trajet</div>
    <div id="travelTimeValue">‚Äî</div>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>